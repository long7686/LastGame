{"version":3,"sources":["PlayerBulletScript.js"],"names":["Emitter","require","cc","Class","extends","Component","properties","greenBulletPre","Prefab","blueBulletPre","redBulletPre","orangeBulletPre","_currentBullet","_currentPre","_greenFlag","_blueFlag","_redFlag","_orangeFlag","_canShootFlag","_countDown","onLoad","instance","registerEvent","typeOfBullet","bind","letShoot","greenFlag","blueFlag","redFlag","orangeFlag","bulletPos","node","convertToWorldSpaceAR","position","parent","convertToNodeSpaceAR","currentBullet","instantiate","Canvas","redBullet1","redBullet2","angle","redBullet3","update","countTimeShoot"],"mappings":"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","file":"PlayerBulletScript.js","sourceRoot":"../../../../assets/Scripts","sourcesContent":["const Emitter = require(\"EventsListener\");\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        greenBulletPre: cc.Prefab,\n        blueBulletPre: cc.Prefab,\n        redBulletPre: cc.Prefab,\n        orangeBulletPre: cc.Prefab,\n        _currentBullet: null,\n        _currentPre: null,\n        _greenFlag: false,\n        _blueFlag: false,\n        _redFlag: false,\n        _orangeFlag: false,\n        _canShootFlag: false,\n        _countDown: 0,\n    },\n\n    onLoad () {\n        Emitter.instance = new Emitter()\n        Emitter.instance.registerEvent(\"skin\", this.typeOfBullet.bind(this))\n        Emitter.instance.registerEvent(\"letShoot\", this.letShoot.bind(this))\n    },\n\n    typeOfBullet(greenFlag, blueFlag, redFlag, orangeFlag){\n        this._canShootFlag = true\n        if (greenFlag){\n            this._currentPre = this.greenBulletPre \n        }\n        else if(blueFlag){\n            this._currentPre = this.blueBulletPre\n        }\n        else if(redFlag){\n            this._currentPre = this.redBulletPre\n        }\n        else if(orangeFlag){\n            this._currentPre = this.orangeBulletPre \n        }\n    },\n\n    letShoot(){\n        this.bulletPos = this.node.convertToWorldSpaceAR(this.node.position);\n        this.bulletPos = this.node.parent.parent.convertToNodeSpaceAR(this.bulletPos);\n        if (this._canShootFlag){\n            this._countDown = 0\n            this._canShootFlag = false;\n            if (this._currentPre != this.redBulletPre){\n                this.currentBullet = cc.instantiate(this._currentPre)\n                this.currentBullet.parent = cc.Canvas.instance.node\n                this.currentBullet.position = this.bulletPos\n            }\n            else if (this._currentPre == this.redBulletPre){\n                let redBullet1 = cc.instantiate(this._currentPre)\n                redBullet1.parent = cc.Canvas.instance.node\n                redBullet1.position = this.bulletPos\n\n                let redBullet2 = cc.instantiate(this._currentPre)\n                redBullet2.parent = cc.Canvas.instance.node\n                redBullet2.position = this.bulletPos\n                redBullet2.angle = 35\n\n                let redBullet3 = cc.instantiate(this._currentPre)\n                redBullet3.parent = cc.Canvas.instance.node\n                redBullet3.position = this.bulletPos\n                redBullet3.angle = -35\n            }\n           \n        }  \n    },\n\n    update(){\n        this.countTimeShoot()\n        \n    },\n\n    countTimeShoot(){\n        if(this._currentPre === this.greenBulletPre){\n            this._countDown += 1\n            if (this._countDown === 5){\n                this._canShootFlag = true;\n            }\n        }\n        else if(this._currentPre === this.blueBulletPre){\n            this._countDown += 1\n            if (this._countDown === 5){\n                this._canShootFlag = true;\n            }\n        }\n        else if (this._currentPre === this.redBulletPre){\n            this._countDown += 1\n            if (this._countDown === 5){\n                this._canShootFlag = true;\n            }\n        }\n        else if (this._currentPre === this.orangeBulletPre){\n            this._countDown += 1\n            if (this._countDown === 5){\n                this._canShootFlag = true;     \n            }\n        }\n        else{\n            // this._canShootFlag = true;     \n            this._countDown = 0\n        }\n    }\n});\n"]}
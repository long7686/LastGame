{"version":3,"sources":["Level1.js"],"names":["Emitter","require","cc","Class","extends","Component","properties","pre1","Prefab","pre2","pre3","_map","_mapColl","_mapRow","_numberOfEnemiesDead","numberOfEnemies","jsonMap","waveID","waveLabel","Label","onLoad","managerCollision","director","getCollisionManager","enabled","enabledDebugDraw","start","instance","registerEvent","controlWave","bind","loader","loadRes","renderMap","log","err","obj","json","Level1","wave1","map","collumn","row","node","active","scale","tween","to","opacity","call","renderWave","index","canvasWid","Canvas","getContentSize","width","canvasHei","height","i","j","enemy","instantiate","parent","position","v2","getComponent","moveToX","moveToY","waveList","wave2","wave3","wave4","wave5","string"],"mappings":"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","file":"Level1.js","sourceRoot":"..\\..\\..\\..\\assets\\Scripts","sourcesContent":["const Emitter = require(\"EventsListener\")\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        pre1: cc.Prefab,\r\n        pre2: cc.Prefab,\r\n        pre3: cc.Prefab,\r\n        _map: null,\r\n        _mapColl: null,\r\n        _mapRow: null,\r\n        _numberOfEnemiesDead:0,\r\n        numberOfEnemies: 0,\r\n        jsonMap: null,\r\n        waveID: 1,\r\n        waveLabel: cc.Label,\r\n    },\r\n\r\n    onLoad(){\r\n        let managerCollision = cc.director.getCollisionManager();\r\n        managerCollision.enabled = true;\r\n        managerCollision.enabledDebugDraw = true\r\n    },\r\n\r\n    start () {\r\n        Emitter.instance.registerEvent(\"countEnemies\", this.controlWave.bind(this))\r\n        cc.loader.loadRes(\"renderMap1.json\", this.renderMap.bind(this)) \r\n        cc.log()\r\n    },\r\n\r\n    renderMap(err, obj){\r\n        if (err){\r\n            cc.log(err)\r\n            return;\r\n        }\r\n        this.waveID = 1\r\n        this.jsonMap = obj\r\n        this._map = this.jsonMap.json.Level1.wave1.map\r\n        this._mapColl = this.jsonMap.json.Level1.wave1.collumn\r\n        this._mapRow = this.jsonMap.json.Level1.wave1.row\r\n        this.numberOfEnemies = this.jsonMap.json.Level1.wave1.numberOfEnemies\r\n        this.waveLabel.node.active = true;\r\n        this.waveLabel.node.scale = 0\r\n        cc.tween(this.waveLabel.node)\r\n        .to(1,{scale: 1})\r\n        .to(.5,{opacity: 0})\r\n        .to(.5,{opacity: 255})\r\n        .to(.5,{opacity: 0})\r\n        .to(.5,{opacity: 255})\r\n        .to(1,{scale: 0})\r\n        .call(() => this.waveLabel.node.active = false)\r\n        .call(() => this.renderWave(this._map, this._mapColl, this._mapRow))\r\n        .start()\r\n        \r\n    },\r\n\r\n    renderWave(map, collumn, row){\r\n        let index = 0;\r\n        let canvasWid = cc.Canvas.instance.node.getContentSize().width\r\n        let canvasHei = cc.Canvas.instance.node.getContentSize().height\r\n        for (let i = 0; i <= row-1; i++){\r\n             for (let j = 0; j <= collumn-1; j++){\r\n                if (map[index]=== 1){\r\n                    let enemy = cc.instantiate(this.pre1)\r\n                    enemy.parent = cc.Canvas.instance.node\r\n                    enemy.position = cc.v2(0, canvasHei)\r\n                    //enemy.position = cc.v2((canvasWid/collumn) * j- 420, (-(canvasHei/(2*row))*i)+250)\r\n                    enemy.getComponent('enemyVerticalShoot').moveToX = (canvasWid/collumn) * j- 420;\r\n                    enemy.getComponent('enemyVerticalShoot').moveToY = (-(canvasHei/(2*row))*i)+250;\r\n                }\r\n                else if (map[index]=== 2){\r\n                    let enemy = cc.instantiate(this.pre2)\r\n                    enemy.parent = cc.Canvas.instance.node\r\n                    enemy.position = cc.v2((canvasWid/collumn) * j- 420, (-(canvasHei/(2*row))*i)+250)\r\n                    enemy.position = cc.v2(0, canvasHei)\r\n                    enemy.getComponent('enemyThreeWayShoot').moveToX = (canvasWid/collumn) * j- 420;\r\n                    enemy.getComponent('enemyThreeWayShoot').moveToY = (-(canvasHei/(2*row))*i)+250;\r\n                }\r\n                else if (map[index]=== 3){\r\n                    let enemy = cc.instantiate(this.pre3)\r\n                    enemy.parent = cc.Canvas.instance.node\r\n                    enemy.position = cc.v2((canvasWid/collumn) * j- 420, (-(canvasHei/(2*row))*i)+250)\r\n                    enemy.position = cc.v2(0, canvasHei)\r\n                    enemy.getComponent('enemyPlayerShoot').moveToX = (canvasWid/collumn) * j- 420;\r\n                    enemy.getComponent('enemyPlayerShoot').moveToY = (-(canvasHei/(2*row))*i)+250;\r\n                }\r\n                index++\r\n            }   \r\n        }\r\n    },\r\n\r\n    controlWave(){\r\n        this._numberOfEnemiesDead++\r\n        if (this._numberOfEnemiesDead === this.numberOfEnemies){\r\n            this.waveID++\r\n            this.waveList()\r\n            this._numberOfEnemiesDead =0\r\n            //call function label wave and render wave\r\n        }\r\n    },\r\n\r\n\r\n    waveList(){\r\n        if (this.waveID === 2){\r\n            this._map = this.jsonMap.json.Level1.wave2.map\r\n            this._mapColl = this.jsonMap.json.Level1.wave2.collumn\r\n            this._mapRow = this.jsonMap.json.Level1.wave2.row\r\n            this.numberOfEnemies = this.jsonMap.json.Level1.wave2.numberOfEnemies\r\n        }\r\n        else if(this.waveID ===3){\r\n            this._map = this.jsonMap.json.Level1.wave3.map\r\n            this._mapColl = this.jsonMap.json.Level1.wave3.collumn\r\n            this._mapRow = this.jsonMap.json.Level1.wave3.row\r\n            this.numberOfEnemies = this.jsonMap.json.Level1.wave3.numberOfEnemies\r\n        }\r\n        else if(this.waveID ===4){\r\n            this._map = this.jsonMap.json.Level1.wave4.map\r\n            this._mapColl = this.jsonMap.json.Level1.wave4.collumn\r\n            this._mapRow = this.jsonMap.json.Level1.wave4.row\r\n            this.numberOfEnemies = this.jsonMap.json.Level1.wave4.numberOfEnemies\r\n        }\r\n        else if(this.waveID ===5){\r\n            this._map = this.jsonMap.json.Level1.wave5.map\r\n            this._mapColl = this.jsonMap.json.Level1.wave5.collumn\r\n            this._mapRow = this.jsonMap.json.Level1.wave5.row\r\n            this.numberOfEnemies = this.jsonMap.json.Level1.wave5.numberOfEnemies\r\n        }\r\n\r\n        this.waveLabel.string = \"Wave \" + this.waveID\r\n        this.waveLabel.node.active = true;\r\n        this.waveLabel.node.scale = 0\r\n        cc.tween(this.waveLabel.node)\r\n        .to(1,{scale: 1})\r\n        .to(.5,{opacity: 0})\r\n        .to(.5,{opacity: 255})\r\n        .to(.5,{opacity: 0})\r\n        .to(.5,{opacity: 255})\r\n        .to(1,{scale: 0})\r\n        .call(() => this.waveLabel.node.active = false)\r\n        .call(() => this.renderWave(this._map, this._mapColl, this._mapRow))\r\n        .start()\r\n    }\r\n\r\n});\r\n"]}
{"version":3,"sources":["enemyPlayerShoot.js"],"names":["Emitter","require","cc","Class","extends","properties","prefabBullet","Prefab","_timerShoot","maxHealth","start","moving","randomAction","Math","random","tween","node","to","x","moveToX","y","moveToY","call","standingAction1","standingAction2","repeatForever","by","shoot","bulletToX","bulletToY","bulletPos","convertToWorldSpaceAR","position","convertToNodeSpaceAR","enemyBullet","instantiate","setPosition","parent","getComponent","update","dt","positionXPlayer","getChildByName","positionYPlayer","dead","instance","emit","destroy"],"mappings":"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","file":"enemyPlayerShoot.js","sourceRoot":"../../../../assets/Scripts","sourcesContent":["const Emitter = require(\"EventsListener\")\ncc.Class({\n    extends: require(\"enemyNoShoot\"),\n\n    properties: {\n        prefabBullet : cc.Prefab,\n        _timerShoot : 0,\n        maxHealth:100,\n    },\n\n    // LIFE-CYCLE CALLBACKS:\n\n    // onLoad () {},\n\n    start () {\n        this.moving()\n    },\n\n    moving(){\n        let randomAction = Math.random()\n        cc.tween(this.node)\n            .to(1.5, {x: this.moveToX, y: this.moveToY})\n            .call(() =>{\n                if (randomAction >0.5){\n                    this.standingAction1()\n                }\n                else{\n                    this.standingAction2()\n                }\n            })\n            .start();\n    },\n\n    standingAction1(){\n        cc.tween(this.node)\n            .repeatForever(\n                cc.tween(this.node)\n                    .by(1,{x:10})\n                    .by(2,{x:-20})\n                    .by(1,{x:10})\n            )\n            .start()\n    },\n\n    standingAction2(){\n        cc.tween(this.node)\n            .repeatForever(\n                cc.tween(this.node)\n                    .by(1,{x:-10})\n                    .by(2,{x:20})\n                    .by(1,{x:-10})\n            )\n            .start()\n    },\n\n    shoot(bulletToX, bulletToY){\n        let bulletPos = this.node.convertToWorldSpaceAR(this.node.position);\n        bulletPos = this.node.convertToNodeSpaceAR(bulletPos);\n\n        let enemyBullet = cc.instantiate(this.prefabBullet);\n        enemyBullet.setPosition(bulletPos.x, bulletPos.y);\n        enemyBullet.parent = this.node.parent;\n        \n        enemyBullet.getComponent('bulletPlayer').bulletToX = bulletToX;\n        enemyBullet.getComponent('bulletPlayer').bulletToY = bulletToY;\n        // cc.log(bulletToX, bulletToY)\n\n    },\n\n    update (dt) {\n        this._timerShoot+= dt;\n        if(this._timerShoot >= 1){\n            let positionXPlayer = this.node.parent.getChildByName('Main Game').getChildByName('Player').x;\n            let positionYPlayer = this.node.parent.getChildByName('Main Game').getChildByName('Player').y;\n            //cc.log(this.node.parent);\n            this.shoot(positionXPlayer, positionYPlayer);\n            this._timerShoot= 0;\n        }\n        if (this.maxHealth <= 0){\n            this.dead()\n        }\n    },\n\n    dead(){\n        Emitter.instance.emit(\"countEnemies\")\n        this.node.destroy()\n    }\n});\n"]}
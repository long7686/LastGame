{"version":3,"sources":["SpaceShip Controller.js"],"names":["Emitter","require","cc","Class","extends","Component","properties","_mousePos","v2","playerHealth","_currentSkin","spriteFrameGreen","default","type","SpriteFrame","_flag","spriteFrameBlue","spriteFrameRed","spriteFrameOrange","timing","Label","nodeEndGame","Node","onLoad","Canvas","instance","node","on","getMousePosition","bind","shoot","systemEvent","SystemEvent","EventType","KEY_DOWN","onKeyDown","KEY_UP","onKeyUp","getComponent","Sprite","event","getLocation","_button","emit","keyCode","macro","KEY","z","changeSkin","x","c","v","update","dt","myCanvasSize","getContentSize","position","width","y","height","spriteFrame","onCollisionEnter","other","self","group","dead","destroy","getDamge","tween","to","opacity","start","totalTime","active"],"mappings":"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","file":"SpaceShip Controller.js","sourceRoot":"..\\..\\..\\..\\assets\\Scripts","sourcesContent":["const Emitter = require(\"EventsListener\")\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        _mousePos: cc.v2,\r\n        playerHealth: 100,\r\n        _currentSkin: null,\r\n        spriteFrameGreen: {\r\n            default: null,\r\n            type: cc.SpriteFrame,\r\n            _flag: false\r\n        },\r\n\r\n        spriteFrameBlue: {\r\n            default: null,\r\n            type: cc.SpriteFrame,\r\n            _flag: false,\r\n        },\r\n\r\n        spriteFrameRed: {\r\n            default: null,\r\n            type: cc.SpriteFrame,\r\n            _flag: false,\r\n        },\r\n\r\n        spriteFrameOrange: {\r\n            default: null,\r\n            type: cc.SpriteFrame,\r\n            _flag: false \r\n        },\r\n        timing: cc.Label,\r\n        nodeEndGame: cc.Node\r\n    },\r\n\r\n\r\n    onLoad () {\r\n        cc.Canvas.instance.node.on(\"mousemove\", this.getMousePosition.bind(this))\r\n        this.node.on(\"mousedown\", this.shoot, this)\r\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN, this.onKeyDown, this);\r\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP, this.onKeyUp, this);\r\n        this._currentSkin = this.node.getComponent(cc.Sprite)\r\n    },\r\n\r\n    getMousePosition(event){\r\n        this._mousePos = event.getLocation()\r\n    },\r\n\r\n    shoot(event){\r\n        if (event._button === 0){\r\n            Emitter.instance.emit(\"letShoot\")\r\n        }\r\n    },\r\n\r\n    onKeyDown(event){\r\n        if (this.node !== null){\r\n            this.spriteFrameGreen._flag = false\r\n            this.spriteFrameBlue._flag = false\r\n            this.spriteFrameRed._flag = false\r\n            this.spriteFrameOrange._flag = false\r\n            switch(event.keyCode){\r\n                case cc.macro.KEY.z:\r\n                    this.spriteFrameGreen._flag = true\r\n                    this.changeSkin()\r\n                    break;\r\n                case cc.macro.KEY.x:\r\n                    this.spriteFrameBlue._flag = true\r\n                    this.changeSkin()\r\n                    break;\r\n                case cc.macro.KEY.c:\r\n                    this.spriteFrameRed._flag = true\r\n                    this.changeSkin()\r\n                    break;\r\n                case cc.macro.KEY.v:\r\n                    this.spriteFrameOrange._flag = true\r\n                    this.changeSkin()\r\n                    break;\r\n            }\r\n        }\r\n    },    \r\n\r\n    update (dt) {\r\n        let myCanvasSize = cc.Canvas.instance.node.getContentSize()\r\n        if (this._mousePos != null){\r\n            this.node.position = cc.v2(this._mousePos.x - (myCanvasSize.width/2), this._mousePos.y - (myCanvasSize.height/2)) \r\n        }   \r\n    },\r\n\r\n    changeSkin(){\r\n        if (this.spriteFrameGreen._flag){\r\n            this._currentSkin.spriteFrame = this.spriteFrameGreen\r\n            Emitter.instance.emit(\"skin\", this.spriteFrameGreen._flag, this.spriteFrameBlue._flag, this.spriteFrameRed._flag, this.spriteFrameOrange._flag)\r\n        }\r\n        else if(this.spriteFrameBlue._flag){\r\n            this._currentSkin.spriteFrame = this.spriteFrameBlue\r\n            Emitter.instance.emit(\"skin\", this.spriteFrameGreen._flag, this.spriteFrameBlue._flag, this.spriteFrameRed._flag, this.spriteFrameOrange._flag)\r\n        }\r\n        else if(this.spriteFrameRed._flag){\r\n            this._currentSkin.spriteFrame = this.spriteFrameRed\r\n            Emitter.instance.emit(\"skin\", this.spriteFrameGreen._flag, this.spriteFrameBlue._flag, this.spriteFrameRed._flag, this.spriteFrameOrange._flag)\r\n        }\r\n        else if (this.spriteFrameOrange._flag){\r\n            this._currentSkin.spriteFrame = this.spriteFrameOrange\r\n            Emitter.instance.emit(\"skin\", this.spriteFrameGreen._flag, this.spriteFrameBlue._flag, this.spriteFrameRed._flag, this.spriteFrameOrange._flag)\r\n        }\r\n    },\r\n\r\n    onCollisionEnter(other, self){\r\n        if ((other.node.group == \"Enemies\")||(other.node.group == \"Boss\")){\r\n            this.dead()\r\n        }\r\n        else if (other.node.group == \"Enemies Bullet\"){\r\n            other.node.destroy()\r\n            this.playerHealth -= 10\r\n                if (this.playerHealth<=0){\r\n                    Emitter.instance.emit(\"healthbar\",this.playerHealth)\r\n                    this.dead()\r\n                }\r\n                else{\r\n                    this.getDamge()\r\n                }\r\n        }\r\n    },\r\n\r\n    getDamge(){\r\n        Emitter.instance.emit(\"healthbar\",this.playerHealth)\r\n        cc.tween(this.node)\r\n            .to(0.1,{opacity: 155})\r\n            .to(0.1,{opacity: 255})\r\n            .to(0.1,{opacity: 155})\r\n            .to(0.1,{opacity: 255})\r\n            .to(0.1,{opacity: 155})\r\n            .to(0.1,{opacity: 255})\r\n            .start()\r\n    },\r\n\r\n    dead(){\r\n        let totalTime = this.timing.getComponent('updatingTime').totalTime;\r\n        this.nodeEndGame.active = true;\r\n        Emitter.instance.emit(\"playerDead\")\r\n        Emitter.instance.emit(\"endGame\", totalTime)\r\n        this.node.destroy()\r\n    },\r\n     \r\n    \r\n});\r\n"]}
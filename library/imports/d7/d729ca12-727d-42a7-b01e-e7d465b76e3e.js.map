{"version":3,"sources":["../../../../assets/Scripts/assets/Scripts/gameOver.js"],"names":["Emitter","require","cc","Class","extends","Component","properties","editBoxName","EditBox","btnEnterName","Button","btnHome","prefabRanking","Prefab","scrollViewRanking","ScrollView","_content","arrRanking","_time","onLoad","node","getChildByName","instance","registerEvent","getTime","bind","rank","sys","localStorage","getItem","JSON","parse","time","homeClick","director","loadScene","enterName","newRank","name","string","Number","push","sortArrRanking","setItem","stringify","showRanking","active","arrayRanking","firstPositionPrefabs","removeAllChildren","i","length","itemRanking","instantiate","nameRanking","timeRanking","getComponent","Label","timeConvert","parent","y","arr","j","temp","num","minutes","Math","floor","seconds"],"mappings":"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","file":"gameOver.js","sourceRoot":"../../../../assets/Scripts","sourcesContent":["const Emitter = require(\"EventsListener\")\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        editBoxName : cc.EditBox,\n        btnEnterName : cc.Button,\n        btnHome : cc.Button,\n        prefabRanking : cc.Prefab,\n        scrollViewRanking : cc.ScrollView,\n        _content : null,\n        arrRanking: [],\n        _time:0,\n    },\n\n\n\n    onLoad () {\n        this._content = this.scrollViewRanking.node.getChildByName(\"view\").getChildByName(\"content\");\n        Emitter.instance.registerEvent(\"endGame\", this.getTime.bind(this));\n        let rank = cc.sys.localStorage.getItem('ranked');\n        if(rank !== null){\n            this.arrRanking = JSON.parse(rank);\n        }else{\n            this.arrRanking =[];\n        }\n    },\n\n    \n    getTime(time){\n        this._time = time;\n    },\n\n    homeClick(){\n        cc.director.loadScene(\"Game\");\n    },\n    \n    enterName(){\n        let newRank = {\n            name: '',\n            time: 0,\n        }\n        newRank.name = this.editBoxName.string;\n        newRank.time = Number(this._time);\n        this.arrRanking.push(newRank);\n        this.sortArrRanking(this.arrRanking);\n        cc.sys.localStorage.setItem('ranked', JSON.stringify(this.arrRanking));\n        \n        this.showRanking(this.arrRanking);\n        this.scrollViewRanking.node.active = true;\n        this.btnEnterName.node.active = false;\n        this.btnHome.node.active = true;\n    },\n\n    showRanking(arrayRanking){\n        let firstPositionPrefabs= 0;\n        this._content.removeAllChildren(true);\n        for (let i = 0; i < arrayRanking.length; i++) {\n            let itemRanking = cc.instantiate(this.prefabRanking);\n            let nameRanking = itemRanking.getChildByName('lblName');\n            let timeRanking = itemRanking.getChildByName('lblTime');\n            nameRanking.getComponent(cc.Label).string = arrayRanking[i].name;\n            timeRanking.getComponent(cc.Label).string = this.timeConvert(arrayRanking[i].time);\n            itemRanking.parent = this._content;\n            itemRanking.y = firstPositionPrefabs -= 31;\n        }\n    },\n    \n    sortArrRanking(arr) {\n        for (let i = 0; i < arr.length-1; i++) {\n            for (let j = i + 1; j < arr.length; j++) {\n                if (arr[i].time > arr[j].time) {\n                    // [arr[i], arr[j]] = [arr[j], arr[i]];\n                    let temp = arr[i];\n                    arr[i] = arr[j];\n                    arr[j] = temp;\n                }\n            }\n        }\n    },\n\n\n    timeConvert(num)\n    { \n        let minutes = Math.floor(num / 60);\n        if(minutes < 10) minutes = \"0\" + minutes\n        let seconds = num % 60;\n        if(seconds < 10) seconds = \"0\" + seconds\n        return minutes + \":\" + seconds;\n    },\n\n    // update (dt) {},\n});\n"]}
{"version":3,"sources":["..\\..\\..\\..\\assets\\Scripts/assets\\Scripts\\enemyPlayerShoot.js"],"names":["Emitter","require","cc","Class","extends","Component","properties","prefabBullet","Prefab","_timerShoot","maxHealth","healthBar","ProgressBar","start","moving","randomAction","Math","random","tween","node","to","x","moveToX","y","moveToY","call","standingAction1","standingAction2","repeatForever","by","shoot","bulletToX","bulletToY","bulletPos","convertToWorldSpaceAR","position","convertToNodeSpaceAR","enemyBullet","instantiate","setPosition","parent","getComponent","update","dt","playerPosition","getChildByName","positionXPlayer","positionYPlayer","dead","getDamage","progress","instance","emit","destroy"],"mappings":"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","file":"enemyPlayerShoot.js","sourceRoot":"..\\..\\..\\..\\assets\\Scripts","sourcesContent":["const Emitter = require(\"EventsListener\")\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        prefabBullet : cc.Prefab,\r\n        _timerShoot : 0,\r\n        maxHealth:100,\r\n        healthBar: cc.ProgressBar\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    // onLoad () {},\r\n\r\n    start () {\r\n        this.moving()\r\n        //Emitter.instance.registerEvent(\"playerDead\", this.dead.bind(this))\r\n    },\r\n\r\n    moving(){\r\n        let randomAction = Math.random()\r\n        cc.tween(this.node)\r\n            .to(1.5, {x: this.moveToX, y: this.moveToY})\r\n            .call(() =>{\r\n                if (randomAction >0.5){\r\n                    this.standingAction1()\r\n                }\r\n                else{\r\n                    this.standingAction2()\r\n                }\r\n            })\r\n            .start();\r\n    },\r\n\r\n    standingAction1(){\r\n        cc.tween(this.node)\r\n            .repeatForever(\r\n                cc.tween(this.node)\r\n                    .by(1,{x:10})\r\n                    .by(2,{x:-20})\r\n                    .by(1,{x:10})\r\n            )\r\n            .start()\r\n    },\r\n\r\n    standingAction2(){\r\n        cc.tween(this.node)\r\n            .repeatForever(\r\n                cc.tween(this.node)\r\n                    .by(1,{x:-10})\r\n                    .by(2,{x:20})\r\n                    .by(1,{x:-10})\r\n            )\r\n            .start()\r\n    },\r\n\r\n    shoot(bulletToX, bulletToY){\r\n        let bulletPos = this.node.convertToWorldSpaceAR(this.node.position);\r\n        bulletPos = this.node.convertToNodeSpaceAR(bulletPos);\r\n\r\n        let enemyBullet = cc.instantiate(this.prefabBullet);\r\n        enemyBullet.setPosition(bulletPos.x, bulletPos.y);\r\n        enemyBullet.parent = this.node.parent;\r\n        \r\n        enemyBullet.getComponent('bulletPlayer').bulletToX = bulletToX;\r\n        enemyBullet.getComponent('bulletPlayer').bulletToY = bulletToY;\r\n\r\n    },\r\n\r\n    update (dt) {\r\n        this._timerShoot+= dt;\r\n        if(this._timerShoot >= 1){\r\n            let playerPosition = this.node.parent.getChildByName('Main Game').getChildByName('Player');\r\n            if(playerPosition != null){\r\n                let positionXPlayer = playerPosition.x;\r\n                let positionYPlayer = playerPosition.y;\r\n                this.shoot(positionXPlayer, positionYPlayer);\r\n                \r\n            }\r\n            this._timerShoot= 0;\r\n        }\r\n        if (this.maxHealth <= 0){\r\n            this.dead()\r\n        }    \r\n       \r\n    },\r\n\r\n    getDamage(){\r\n        this.healthBar.getComponent(cc.ProgressBar).progress= this.maxHealth/100 \r\n    },\r\n\r\n    dead(){\r\n        Emitter.instance.emit(\"countEnemies\")\r\n        this.node.destroy()\r\n    }\r\n});\r\n"]}